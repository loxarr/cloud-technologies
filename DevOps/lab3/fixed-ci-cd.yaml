apiVersion: batch/v1
kind: Job
metadata:
  name: fixed-ci-cd-test
  namespace: ci-cd
spec:
  template:
    spec:
      serviceAccountName: ci-cd-service-account
      containers:
      - name: ci-runner
        image: alpine/k8s:latest  # –≠—Ç–æ—Ç –æ–±—Ä–∞–∑ –∏–º–µ–µ—Ç /bin/sh
        command: ["/bin/sh"]
        args:
        - -c
        - |
          set -e
          echo "üöÄ Starting CI/CD pipeline"
          echo "=========================="
          
          # –¢–µ—Å—Ç–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
          echo "1. Testing environment..."
          hostname
          pwd
          ls -la
          
          echo "2. Testing kubectl..."
          kubectl version --client
          
          echo "3. Testing Kubernetes access..."
          kubectl get nodes
          
          echo "4. Testing permissions..."
          kubectl auth can-i get pods --namespace=ci-cd
          
          echo "=========================="
          echo "‚úÖ CI/CD Test COMPLETED SUCCESSFULLY!"
      restartPolicy: Never
